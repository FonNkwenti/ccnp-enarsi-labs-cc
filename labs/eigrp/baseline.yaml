chapter: eigrp
version: "1.0"
exam: 300-410 ENARSI
blueprint_sections:
  - "1.9 Troubleshoot EIGRP (classic and named mode)"
  - "1.9.a Address families (IPv4, IPv6)"
  - "1.9.b Neighbor adjacency"
  - "1.9.c Loop-free path selection (RD, FD, FC, successor, feasible successor)"
  - "1.9.d Stubs"
  - "1.9.e Load balancing (equal-cost, unequal-cost)"
  - "1.9.f Metrics"
  - "1.1 Troubleshoot administrative distance"
  - "1.2 Troubleshoot route map (filtering, tagging)"
  - "1.3 Troubleshoot loop prevention mechanisms (split horizon, route poisoning)"
  - "1.5 Troubleshoot manual and auto-summarization"

# ─────────────────────────────────────────────
# CORE TOPOLOGY  (Labs 01–05, active throughout)
# Triangle: R1 (hub) ↔ R2 ↔ R3, with R1 also connecting to R2 and R3 directly
# ─────────────────────────────────────────────
core_topology:

  devices:
    - name: R1
      platform: c7200
      role: Hub / Core
      console_port: 5001
      loopback0:
        ipv4: 10.0.0.1/32
        ipv6: "2001:db8::1/128"
      # Slot 0: C7200-IO-FE  → fa0/0
      # Slot 1: PA-2FE-TX    → fa1/0, fa1/1
      # Slot 2: PA-4T+       → s2/0–s2/3 (unused)
      # Slot 3: PA-GE        → gi3/0 (unused)
      interfaces:
        fa0/0: "10.12.0.1/30 — link to R2; ipv6 2001:db8:12::1/64"
        fa1/0: "10.13.0.1/30 — link to R3; ipv6 2001:db8:13::1/64"
        fa1/1: "10.14.0.1/30 — link to R4 (optional, activated in lab-06)"

    - name: R2
      platform: c3725
      role: Branch A
      console_port: 5002
      loopback0:
        ipv4: 10.0.0.2/32
        ipv6: "2001:db8::2/128"
      loopback1:
        ipv4: 172.16.20.1/24
        note: "Summarization lab (lab-05+)"
      loopback2:
        ipv4: 172.16.21.1/24
        note: "Summarization lab (lab-05+)"
      # Slot 0: GT96100-FE   → fa0/0, fa0/1
      interfaces:
        fa0/0: "10.12.0.2/30 — link to R1; ipv6 2001:db8:12::2/64"
        fa0/1: "10.23.0.1/30 — link to R3; ipv6 2001:db8:23::1/64"

    - name: R3
      platform: c3725
      role: Branch B
      console_port: 5003
      loopback0:
        ipv4: 10.0.0.3/32
        ipv6: "2001:db8::3/128"
      loopback1:
        ipv4: 172.16.30.1/24
        note: "Summarization lab (lab-05+)"
      loopback2:
        ipv4: 172.16.31.1/24
        note: "Summarization lab (lab-05+)"
      interfaces:
        fa0/0: "10.13.0.2/30 — link to R1; ipv6 2001:db8:13::2/64"
        fa0/1: "10.23.0.2/30 — link to R2; ipv6 2001:db8:23::2/64"

  links:
    - id: L1
      source: "R1:fa0/0"
      target: "R2:fa0/0"
      subnet_ipv4: 10.12.0.0/30
      subnet_ipv6: "2001:db8:12::/64"
      description: R1 Hub to Branch A
    - id: L2
      source: "R1:fa1/0"
      target: "R3:fa0/0"
      subnet_ipv4: 10.13.0.0/30
      subnet_ipv6: "2001:db8:13::/64"
      description: R1 Hub to Branch B
    - id: L3
      source: "R2:fa0/1"
      target: "R3:fa0/1"
      subnet_ipv4: 10.23.0.0/30
      subnet_ipv6: "2001:db8:23::/64"
      description: Branch A to Branch B (alternate path)

# ─────────────────────────────────────────────
# OPTIONAL DEVICES  (activated per lab)
# ─────────────────────────────────────────────
optional_devices:
  - name: R4
    platform: c3725
    role: Stub / Edge Router
    console_port: 5004
    available_from: 6
    purpose: >
      Introduces EIGRP stub routing (lab-06), route filtering targets (lab-07),
      administrative distance manipulation (lab-08), and complex troubleshooting (lab-09).
    loopback0:
      ipv4: 10.0.0.4/32
      ipv6: "2001:db8::4/128"
    loopback1:
      ipv4: 192.168.4.0/24
      note: "Stub network advertised by R4"
    interfaces:
      fa0/0: "10.14.0.2/30 — link to R1"

optional_links:
  - id: L4
    source: "R1:fa1/1"
    target: "R4:fa0/0"
    subnet_ipv4: 10.14.0.0/30
    subnet_ipv6: "2001:db8:14::/64"
    available_from: 6
    description: Hub to Stub/Edge router

# ─────────────────────────────────────────────
# LAB SERIES
# ─────────────────────────────────────────────
labs:
  - number: 1
    title: "EIGRP Classic Mode — Neighbor Adjacency & Basic IPv4"
    slug: "lab-01-classic-adjacency"
    difficulty: Foundation
    time_minutes: 60
    blueprint: ["1.9.b"]
    devices: [R1, R2, R3]
    objectives:
      - "Configure EIGRP classic mode (AS 100) on R1, R2, and R3"
      - "Advertise all connected subnets using the network command"
      - "Verify neighbor adjacencies form on all three links (L1, L2, L3)"
      - "Verify full IPv4 reachability using ping and show ip route eigrp"
      - "Troubleshoot: identify and fix AS number mismatch, passive interface, and missing network statement faults"

  - number: 2
    title: "EIGRP Named Mode & Dual-Stack IPv6 Address Family"
    slug: "lab-02-named-mode-dual-stack"
    difficulty: Foundation
    time_minutes: 75
    blueprint: ["1.9.a", "1.9.b"]
    devices: [R1, R2, R3]
    objectives:
      - "Migrate classic EIGRP to Named Mode (router eigrp ENARSI)"
      - "Configure address-family ipv4 unicast autonomous-system 100"
      - "Configure address-family ipv6 unicast autonomous-system 100"
      - "Verify IPv4 and IPv6 neighbor adjacencies and routing tables"
      - "Troubleshoot: address-family configuration errors, missing IPv6 unicast routing, K-value mismatch between address families"

  - number: 3
    title: "EIGRP Metrics — Bandwidth, Delay & K-Values"
    slug: "lab-03-metrics-k-values"
    difficulty: Intermediate
    time_minutes: 90
    blueprint: ["1.9.f"]
    devices: [R1, R2, R3]
    objectives:
      - "Verify default EIGRP composite metric formula and identify each K-value contribution"
      - "Manipulate interface bandwidth and delay to change the preferred path between R1 and R2"
      - "Verify metric changes are reflected in the routing table (new successor)"
      - "Introduce a K-value mismatch and verify adjacency drops; restore correct K-values"
      - "Troubleshoot: K-value mismatch, incorrect bandwidth/delay settings, metric inconsistencies"

  - number: 4
    title: "Loop-Free Path Selection — FD, RD, FC & Feasible Successors"
    slug: "lab-04-feasible-successor"
    difficulty: Intermediate
    time_minutes: 90
    blueprint: ["1.9.c", "1.9.e"]
    devices: [R1, R2, R3]
    objectives:
      - "Identify Feasible Distance (FD) and Reported Distance (RD) for all routes using show ip eigrp topology"
      - "Verify the Feasibility Condition (RD < FD of current successor) for each feasible successor"
      - "Simulate a successor failure and verify automatic failover to the feasible successor"
      - "Configure variance for unequal-cost load balancing across multiple paths"
      - "Troubleshoot: feasibility condition not met (no feasible successor), variance misconfiguration"

  - number: 5
    title: "EIGRP Summarization — Manual and Auto-Summary"
    slug: "lab-05-summarization"
    difficulty: Intermediate
    time_minutes: 75
    blueprint: ["1.5"]
    devices: [R1, R2, R3]
    objectives:
      - "Add loopback interfaces on R2 (172.16.20/21.0/24) and R3 (172.16.30/31.0/24)"
      - "Configure manual summary routes using ip summary-address eigrp on outgoing interfaces"
      - "Verify summarized route appears in neighbors' routing tables (172.16.20.0/23, 172.16.30.0/23)"
      - "Observe and explain the null0 discard route created by summarization"
      - "Troubleshoot: summarization black hole, auto-summary creating discontiguous network issues"

  - number: 6
    title: "EIGRP Stub Routers"
    slug: "lab-06-stub-routing"
    difficulty: Intermediate
    time_minutes: 60
    blueprint: ["1.9.d"]
    devices: [R1, R2, R3, R4]
    objectives:
      - "Add R4 as a stub router connected only to R1 (link L4)"
      - "Configure eigrp stub connected summary on R4"
      - "Verify R4 is not used as a transit path by R1 or other routers"
      - "Verify R4 advertises only its connected and summary routes"
      - "Troubleshoot: stub misconfiguration causing route leaking, R4 used incorrectly as transit"

  - number: 7
    title: "Route Filtering & Route Maps"
    slug: "lab-07-filtering-route-maps"
    difficulty: Advanced
    time_minutes: 90
    blueprint: ["1.2", "1.3"]
    devices: [R1, R2, R3, R4]
    objectives:
      - "Filter specific EIGRP routes using a distribute-list with prefix-list in inbound and outbound directions"
      - "Apply a route-map to set EIGRP route tags for loop prevention"
      - "Verify filtered routes are suppressed and tagged routes are correctly processed"
      - "Troubleshoot: distribute-list applied in wrong direction, route-map sequence logic errors, implicit deny"

  - number: 8
    title: "Administrative Distance & Split Horizon"
    slug: "lab-08-ad-split-horizon"
    difficulty: Advanced
    time_minutes: 75
    blueprint: ["1.1", "1.3"]
    devices: [R1, R2, R3, R4]
    objectives:
      - "Modify EIGRP internal and external AD to influence route preference vs. static routes"
      - "Observe split horizon suppressing routes on hub interfaces; disable on R1 fa0/0 and verify impact"
      - "Configure a static route with AD 90 to override an EIGRP route and verify routing table"
      - "Troubleshoot: floating static routes, split horizon causing incomplete routing in hub-spoke scenario"

  - number: 9
    title: "EIGRP Full Protocol Mastery — Capstone I"
    slug: "lab-09-capstone-i"
    type: capstone_i
    clean_slate: true
    difficulty: Advanced
    time_minutes: 120
    blueprint: ["1.9.a", "1.9.b", "1.9.c", "1.9.d", "1.9.e", "1.9.f", "1.1", "1.2", "1.3", "1.5"]
    devices: [R1, R2, R3, R4]
    objectives:
      - "Configure EIGRP Named Mode (AS 100) from scratch on all four routers — no step-by-step guidance"
      - "Enable dual-stack (IPv4 + IPv6 address families) across all links and loopbacks"
      - "Tune EIGRP metrics so that R1→R3 is the preferred path from R2 (verify via show ip eigrp topology)"
      - "Configure R4 as an EIGRP stub router advertising only connected and summary routes"
      - "Apply manual summarization on R2 and R3 outbound interfaces for their loopback prefixes"
      - "Filter R4's stub network from being advertised to R3 using a distribute-list with prefix-list"
      - "Set EIGRP internal AD to 80 on R1 to prefer EIGRP over any static routes"
      - "Disable split horizon on R1 fa0/0 and verify R2 now receives R3's loopback via R1"
      - "Verify complete IPv4 and IPv6 reachability across all four routers"

  - number: 10
    title: "EIGRP Comprehensive Troubleshooting — Capstone II"
    slug: "lab-10-capstone-ii"
    type: capstone_ii
    clean_slate: true
    difficulty: Advanced
    time_minutes: 120
    blueprint: ["1.9.a", "1.9.b", "1.9.c", "1.9.d", "1.9.e", "1.9.f", "1.1", "1.2", "1.3", "1.5"]
    devices: [R1, R2, R3, R4]
    objectives:
      - "Diagnose and resolve a multi-cause EIGRP adjacency failure (AS mismatch + passive interface)"
      - "Identify and fix incorrect path selection caused by metric manipulation (delay misconfiguration)"
      - "Resolve a broken stub configuration where R4 is incorrectly leaking transit routes"
      - "Fix a summarization black hole causing unreachable loopback prefixes"
      - "Correct an administrative distance misconfiguration causing a static route to override EIGRP"
      - "Restore full IPv4 and IPv6 reachability across all four routers"
